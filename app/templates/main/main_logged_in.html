{% extends "base.html" %}

{% from "card.html" import card %}
{% import "map.html" as map %}

{% block imports %}
    {{ map.imports() }}
{% endblock %}

{% block styles %}
    #mapid {
    height: 100%;
    }
{% endblock %}

{% block body %}
    <!--<section class="section">-->
    <div id="div" style="height: 100%">
        <section class="section" style="height: 100%">
            <div class="columns" style="height: 100%">
                <div class="column is-2">
                    {{ card("Add a new trip", link=url_for("routes_drive.addRoute")) }}

                    {% if future_routes is none %}
                        <div class="card">
                            No routes planned
                        </div>
                    {% else %}
                        {% for trip in future_routes %}
                            <div class="card" style="padding: 10px">
                                <strong>From: </strong> {{ trip.text_from() }} <br>
                                <strong>To: </strong> {{ trip.text_to() }}<br>
                                <strong>{{ trip.departure_time }}</strong> <br>
                                <a class="button" href="{{ url_for('routes_drive.drive',  drive_id=trip.id) }}">More info</a>
                            </div>
                        {% endfor %}
                        <a class="button" href="{{ url_for('routes_drive.history') }}">History</a>
                    {% endif %}

                </div>

                <div class="column">
                    {% if routes.first() is none %}
                        <h1 class="title">
                            No routes planned
                        </h1>
                    {% else %}
                        <h1 class="title">
                            From: {{ routes.first().text_from() }}<br>
                            To: {{ routes.first().text_to() }}
                        </h1>
                        <h2 class="subtitle">
                            {{ routes.first().departure_time }}
                        </h2>
                    {% endif %}
                    {{ map.map() }}
                </div>
                <div class="column is-2">
                    {% if routes.first() %}
                        <div class="card">
                            <div class="card-content">
                                <i class="fas fa-car"></i><a
                                    href="{{ url_for('users.user_page', username=routes.first().driver().username) }} "> {{ routes.first().driver().name() }} </a><br>
                                {% if routes.first().passenger_places is none %}
                                    No passengers
                                {% else %}
                                    {% for passenger in routes.first().passenger_places %}
                                        <i class="fas fa-user"></i>
                                        <a href="{{ url_for('users.user_page', username=passenger) }}"> {{ passenger }} </a>
                                        <br>
                                    {% endfor %}
                                {% endif %}
                            </div>
                        </div>

                    {% endif %}<br>


                    {% if routes.first() %}
                        {{ card("FROM:", routes.first().text_from()) }}

                        {% for stop in routes.first().stops %}
                            {{ card("STOP:", stop) }}
                        {% endfor %}

                        {{ card("TO:", routes.first().text_to()) }}

                    {% endif %}

                </div>
            </div>
        </section>
    </div>
{% endblock %}